<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Photo Studio - Th·∫£o M·ªπ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-image: url('https://r.jina.ai/i/6f0b3b85040e4f8fb2587009477e5623'); 
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            margin: 0;
        }
        .glass-morphism {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        .tool-card { transition: transform 0.3s; }
        .tool-card:hover { transform: translateY(-5px); }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #d4a373; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="text-gray-800 min-h-screen pb-10">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8 pt-10">
            <h1 class="text-5xl font-bold text-[#8d6e63] drop-shadow-md mb-2">AI PHOTO STUDIO</h1>
            <p class="text-lg text-[#a88d7b] font-medium">Kh√¥ng gian s√°ng t·∫°o c·ªßa Th·∫£o M·ªπ</p>
        </header>
        
        <div id="selectionScreen" class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl mx-auto">
            <div onclick="showTool('generator')" class="tool-card glass-morphism p-8 text-center cursor-pointer">
                <div class="text-6xl mb-4">üé®</div>
                <h2 class="text-2xl font-bold mb-2">Tr√¨nh T·∫°o ·∫¢nh AI</h2>
                <p class="text-sm text-gray-600">T·∫°o ·∫£nh t·ª´ ch√¢n dung v·ªõi nhi·ªÅu phong c√°ch.</p>
            </div>
            <div onclick="showTool('album')" class="tool-card glass-morphism p-8 text-center cursor-pointer">
                <div class="text-6xl mb-4">üì∏</div>
                <h2 class="text-2xl font-bold mb-2">T·∫°o Album</h2>
                <p class="text-sm text-gray-500">7 bi·∫øn th·ªÉ g√≥c ch·ª•p t·ª´ 1 ·∫£nh g·ªëc.</p>
            </div>
            <div onclick="showTool('lookbook')" class="tool-card glass-morphism p-8 text-center cursor-pointer">
                <div class="text-6xl mb-4">üñºÔ∏è</div>
                <h2 class="text-2xl font-bold mb-2">Ch·ª•p S·∫£n Ph·∫©m</h2>
                <p class="text-sm text-gray-500">Bi·∫øn ·∫£nh s·∫£n ph·∫©m th√†nh Lookbook cao c·∫•p.</p>
            </div>
        </div>

        <main id="generatorTool" class="hidden glass-morphism p-6 max-w-4xl mx-auto mt-10">
            <button onclick="goBack()" class="mb-6 text-[#8d6e63] font-bold">&larr; Quay l·∫°i</button>
            <h2 class="text-2xl font-bold text-center mb-6">B∆∞·ªõc 1: T·∫£i ·∫£nh ch√¢n dung</h2>
            <div class="border-2 border-dashed border-[#d4a373] rounded-xl p-10 text-center">
                <input type="file" id="faceInput" class="hidden" accept="image/*" onchange="handleFile(this)">
                <button onclick="document.getElementById('faceInput').click()" class="bg-[#d4a373] text-white px-8 py-3 rounded-full font-bold hover:bg-[#bc8a5f]">Ch·ªçn ·∫£nh c·ªßa ch·ªã</button>
                <div id="previewContainer" class="mt-4 hidden">
                    <img id="facePreview" class="max-w-xs mx-auto rounded-lg shadow-lg">
                </div>
            </div>
            <div id="actionBtn" class="text-center mt-8 hidden">
                <button onclick="generateAI()" class="bg-gradient-to-r from-[#8d6e63] to-[#d4a373] text-white px-12 py-4 rounded-full text-xl font-bold shadow-lg">T·∫†O ·∫¢NH NGAY</button>
            </div>
            <div id="resultArea" class="mt-10 grid grid-cols-1 md:grid-cols-2 gap-4"></div>
        </main>
    </div>

    <script>
        // Kh√≥a API m·ªõi ch·ªã cung c·∫•p
        const MY_API_KEY = "AIzaSyC0uLJ4Uj21o8fdRm3XN54BeWpYa6CH-U4";
        let base64Image = null;

        function showTool(tool) {
            document.getElementById('selectionScreen').classList.add('hidden');
            document.getElementById('generatorTool').classList.remove('hidden');
        }

        function goBack() {
            document.getElementById('selectionScreen').classList.remove('hidden');
            document.getElementById('generatorTool').classList.add('hidden');
        }

        function handleFile(input) {
            const file = input.files[0];
            const reader = new FileReader();
            reader.onload = (e) => {
                base64Image = e.target.result.split(',')[1];
                document.getElementById('facePreview').src = e.target.result;
                document.getElementById('previewContainer').classList.remove('hidden');
                document.getElementById('actionBtn').classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }

        async function generateAI() {
            const resultArea = document.getElementById('resultArea');
            resultArea.innerHTML = '<div class="col-span-full text-center"><div class="loader mx-auto"></div><p class="mt-2 font-bold text-[#8d6e63]">AI ƒëang v·∫Ω ·∫£nh cho ch·ªã, ƒë·ª£i em x√≠u...</p></div>';
            
            const prompt = "A high-end fashion portrait of the person in the image, 8k resolution, cinematic lighting, luxury studio background, elegant pose, perfectly preserving the face features.";
            
            try {
                // G·ª≠i qua Header ƒë·ªÉ kh·ªõp v·ªõi b·∫£o m·∫≠t Restricted Key
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        'x-goog-api-key': MY_API_KEY 
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [
                                { text: prompt },
                                { inlineData: { mimeType: "image/jpeg", data: base64Image } }
                            ]
                        }],
                        generationConfig: { responseModalities: ["IMAGE"] }
                    })
                });

                const data = await response.json();
                
                if (data.error) throw new Error(data.error.message);

                const generatedBase64 = data.candidates[0].content.parts[0].inlineData.data;
                
                resultArea.innerHTML = `
                    <div class="bg-white p-2 rounded-lg shadow-xl">
                        <img src="data:image/png;base64,${generatedBase64}" class="w-full rounded">
                        <a href="data:image/png;base64,${generatedBase64}" download="studio_thao_my.png" class="block text-center mt-2 bg-green-500 text-white py-2 rounded font-bold">T·∫¢I ·∫¢NH V·ªÄ</a>
                    </div>
                `;
            } catch (error) {
                resultArea.innerHTML = `<p class="text-red-500 font-bold col-span-full text-center">L·ªói: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
